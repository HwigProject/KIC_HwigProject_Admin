<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE mapper
PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN"
"http://mybatis.org/dtd/mybatis-3-mapper.dtd">
<mapper namespace="com.hwig.admin.mappers.orderMapper">

<sql id="search">
		<if test="searchType != null">
			<if test="searchType == 'orderid'.toString()">
				and order_id like '%' || #{keyword} || '%'
			</if>
			<if test="searchType == 'memid'.toString()">
				and mem_id like '%' || #{keyword} || '%'
			</if>
		</if>
		<if test="searchType == 'memid'.toString()">
				and mem_id like '%' || #{keyword} || '%'
			</if>
	</sql>

	<select id="orderAllSelectSeller" resultType="OrderVO">
	select * from (
		select rownum,
			A.order_id,
			A.mem_id, 
			A.order_status, 
			A.order_reverse, 
			A.order_paymoney, 
			A.order_payway, 
			to_char(A.order_paydate,'YYYY-MM-DD')as order_paydate, 
			A.order_request, 
			A.order_count,
			row_number() over(order by rownum desc) as rnum
		from tbl_order A,
			tbl_order_b B,
			tbl_prd C
		where A.order_id = B.order_id
			and B.prd_id = C.prd_id
			and C.sel_id = #{sel_id}
		
		<include  refid="search"></include>
		
			) mb where rnum between #{pageStart} and #{pageEnd}
	</select>
	
	<select id="orderAllCountSeller" resultType="int">
		select
			count(A.order_id) 
		from tbl_order A,
			tbl_order_b B,
			tbl_prd C
		where A.order_id = B.order_id
			and B.prd_id = C.prd_id
			and C.sel_id = #{sel_id}
		<include refid="search"></include>
	</select>
	
	<select id="orderAllSelectAdmin" resultType="OrderVO">
	select * from (
		select 
			rownum,
			order_id,
			mem_id, 
			order_status, 
			order_reverse, 
			order_paymoney, 
			order_payway, 
			to_char(order_paydate,'YYYY-MM-DD')as order_paydate, 
			order_request, 
			order_count,
			row_number() over(order by rownum desc) as rnum
		from tbl_order
		where 1=1
		
		<include  refid="search"></include>
		
			) mb where rnum between #{pageStart} and #{pageEnd}
	</select>
	
	<select id="orderAllCountAdmin" resultType="int">
		select
			count(order_id) 
		from tbl_order
		where 1=1;
		<include refid="search"></include>
	</select>

</mapper>